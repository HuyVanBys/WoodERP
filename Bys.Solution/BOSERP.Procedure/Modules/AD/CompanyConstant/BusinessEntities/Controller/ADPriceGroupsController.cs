using System;
using System.Data;
using System.Text;
using System.Collections.Generic;
using eMASLib;


namespace eMASERP
{
	#region ADPriceGroups
	//-----------------------------------------------------------
	//Generated By: eMAS Studio
	//Class:ADPriceGroupsController
	//Created Date:Tuesday, March 27, 2007
	//-----------------------------------------------------------
	
	public class ADPriceGroupsController:BaseBusinessController
	{
		public ADPriceGroupsController()
		{
			dal= new DALBaseProvider("ADPriceGroups",typeof(ADPriceGroupsInfo));
		}
		private int GetADPriceGroupID(int iADPriceGroupID)
		{
			int iResultADPriceGroupID=0;
			int iMaxID=GetMaxID();
			GENumberingInfo objGENumberingInfo=(GENumberingInfo)new GENumberingController().GetObjectByName("PriceGroup");
			if (objGENumberingInfo!=null)
			{
				int iGENumberingStart = objGENumberingInfo.GENumberingStart;
				if (objGENumberingInfo.GENumberingModus == 0)
				{
					if (iGENumberingStart > iMaxID)
						iResultADPriceGroupID=iGENumberingStart;
					else
					{
						iResultADPriceGroupID=iGENumberingStart;
						bool isOk=false;
						while (iResultADPriceGroupID < iMaxID && !isOk)
						{
						if (!IsExist(iResultADPriceGroupID))
							isOk=true;
						iResultADPriceGroupID++;
						}
						if(isOk)
							iResultADPriceGroupID--;
						else
							iResultADPriceGroupID = iMaxID + 1;
					}
				}
				else
				{
					iResultADPriceGroupID = iADPriceGroupID;
				}
			}
			else
			{
			iResultADPriceGroupID = iMaxID + 1;
			}
			return iResultADPriceGroupID;
		}
		public override int CreateObject(BusinessObject objADPriceGroupsInfo)		
		{			
			dal.SetValueToPrimaryColumn(objADPriceGroupsInfo, GetADPriceGroupID(Convert.ToInt32(dal.GetPrimaryColumnValue(objADPriceGroupsInfo))));			
			dal.SetValueToIDStringColumn(objADPriceGroupsInfo, GetADPriceGroupID(Convert.ToInt32(dal.GetPrimaryColumnValue(objADPriceGroupsInfo))));			
			return dal.CreateObject(objADPriceGroupsInfo);		
		}
	}
	#endregion
}