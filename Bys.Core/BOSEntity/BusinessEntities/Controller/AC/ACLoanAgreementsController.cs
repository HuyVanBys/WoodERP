using BOSLib;
using System;
using System.Collections.Generic;
using System.Data;


namespace BOSERP
{
    #region ACLoanAgreements
    //-----------------------------------------------------------
    //Generated By: BOS Studio
    //Class:ACLoanAgreementsController
    //Created Date:Thursday, March 10, 2016
    //-----------------------------------------------------------

    public class ACLoanAgreementsController : BaseBusinessController
    {
        public ACLoanAgreementsController()
        {
            dal = new DALBaseProvider("ACLoanAgreements", typeof(ACLoanAgreementsInfo));
        }

        public void UpdateLoanAgreementForLoanAgreementReceiptAmount(int loanAgreementID)
        {
            dal.ExecuteStoredProcedure("ACLoanAgreements_UpdateLoanAgreementForLoanAgreementReceiptAmount", loanAgreementID);
        }

        public override System.Collections.IList GetListFromDataSet(DataSet ds)
        {
            List<ACLoanAgreementsInfo> loanAgreements = new List<ACLoanAgreementsInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    ACLoanAgreementsInfo loanAgreement = (ACLoanAgreementsInfo)GetObjectFromDataRow(row);
                    loanAgreements.Add(loanAgreement);
                }
            }
            ds.Dispose();
            return loanAgreements;
        }

        public decimal GetRemainAmountByLoanGreementIDAndLoanReceiptID(int loangreementID, int loanreceiptID)
        {
            Object obj = dal.GetSingleValue("ACLoanAgreements_GetRemainAmountByLoanGreementIDAndLoanReceiptID", loangreementID, loanreceiptID);
            decimal Debt = 0;
            if (obj != null)
                Decimal.TryParse(obj.ToString(), out Debt);

            return Debt;
        }

        public List<ACLoanAgreementsInfo> GetDataByDateAndRemainAmount()
        {
            DataSet ds = dal.GetDataSet("ACLoanAgreements_GetDataByDateAndRemainAmount");
            return (List<ACLoanAgreementsInfo>)GetListFromDataSet(ds);
        }

    }
    #endregion
}