using BOSLib;
using System;
using System.Collections.Generic;
using System.Data;


namespace BOSERP
{
    #region MMOperationDetailPlanItems
    //-----------------------------------------------------------
    //Generated By: BOS Studio
    //Class:MMOperationDetailPlanItemsController
    //Created Date:Thursday, August 04, 2016
    //-----------------------------------------------------------

    public class MMOperationDetailPlanItemsController : BaseBusinessController
    {
        public MMOperationDetailPlanItemsController()
        {
            dal = new DALBaseProvider("MMOperationDetailPlanItems", typeof(MMOperationDetailPlanItemsInfo));
        }
        public override System.Collections.IList GetListFromDataSet(DataSet ds)
        {
            List<MMOperationDetailPlanItemsInfo> list = new List<MMOperationDetailPlanItemsInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    MMOperationDetailPlanItemsInfo obj = (MMOperationDetailPlanItemsInfo)GetObjectFromDataRow(row);
                    list.Add(obj);
                }
            }
            ds.Dispose();
            return list;
        }
        public List<MMOperationDetailPlanItemsInfo> GetListFromDataTable(DataTable tb)
        {
            List<MMOperationDetailPlanItemsInfo> list = new List<MMOperationDetailPlanItemsInfo>();
            if (tb.Rows.Count > 0)
            {
                foreach (DataRow row in tb.Rows)
                {
                    MMOperationDetailPlanItemsInfo obj = (MMOperationDetailPlanItemsInfo)GetObjectFromDataRow(row);
                    list.Add(obj);
                }
            }
            return list;
        }

        public List<MMOperationDetailPlanItemsInfo> GetOperationDetailPlanItemByBatchProductItem(int batchProductItemID)
        {
            DataSet ds = dal.GetDataSet("MMOperationDetailPlanItems_GetOperationDetailPlanItemByBatchProductItem", batchProductItemID);
            List<MMOperationDetailPlanItemsInfo> list = new List<MMOperationDetailPlanItemsInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    MMOperationDetailPlanItemsInfo objOperationDetailPlanItemsInfo = (MMOperationDetailPlanItemsInfo)GetObjectFromDataRow(row);
                    list.Add(objOperationDetailPlanItemsInfo);
                }
            }
            ds.Dispose();
            return list;
        }
        public List<MMOperationDetailPlanItemsInfo> GetOperationDetailPlanItemByOperationAndCapacityDate(int OperationDetailPlanCapacityOperationID, DateTime OperationDetailPlanCapacityFromdate)
        {
            DataSet ds = dal.GetDataSet("MMOperationDetailPlanItems_GetOperationDetailPlanItemByOperationAndCapacityDate", OperationDetailPlanCapacityOperationID, OperationDetailPlanCapacityFromdate);
            List<MMOperationDetailPlanItemsInfo> list = new List<MMOperationDetailPlanItemsInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    MMOperationDetailPlanItemsInfo objOperationDetailPlanItemsInfo = (MMOperationDetailPlanItemsInfo)GetObjectFromDataRow(row);
                    list.Add(objOperationDetailPlanItemsInfo);
                }
            }
            ds.Dispose();
            return list;
        }

        public List<MMOperationDetailPlanItemsInfo> GetOperationDetailPlanItemForCompensation(int OperationDetailPlanCapacityOperationID, int OperationDetailPlanID)
        {
            DataSet ds = dal.GetDataSet("MMOperationDetailPlanItems_GetOperationDetailPlanForCompensation", OperationDetailPlanCapacityOperationID, OperationDetailPlanID);
            List<MMOperationDetailPlanItemsInfo> list = new List<MMOperationDetailPlanItemsInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    MMOperationDetailPlanItemsInfo objOperationDetailPlanItemsInfo = (MMOperationDetailPlanItemsInfo)GetObjectFromDataRow(row);
                    objOperationDetailPlanItemsInfo.MMOperationDetailPlanItemID = 0;
                    list.Add(objOperationDetailPlanItemsInfo);
                }
            }
            ds.Dispose();
            return list;
        }

        public List<MMOperationDetailPlanItemsInfo> GetOperationDetailPlanItemByBatchProductItemAndOperationDetailPlan(int batchProductItemID, int operationPlanID)
        {
            DataSet ds = dal.GetDataSet("MMOperationDetailPlanItems_GetOperationDetailPlanItemByBatchProductItemAndOperationDetailPlan", batchProductItemID, operationPlanID);
            List<MMOperationDetailPlanItemsInfo> list = new List<MMOperationDetailPlanItemsInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    MMOperationDetailPlanItemsInfo objOperationDetailPlanItemsInfo = (MMOperationDetailPlanItemsInfo)GetObjectFromDataRow(row);
                    list.Add(objOperationDetailPlanItemsInfo);
                }
            }
            ds.Dispose();
            return list;
        }
        public List<MMOperationDetailPlanItemsInfo> GetOperationDetailPlanItemByProductAndOperationDetailPlan(int ProductID, int operationPlanID)
        {
            DataSet ds = dal.GetDataSet("MMOperationDetailPlanItems_GetOperationDetailPlanItemByProductAndOperationDetailPlan", ProductID, operationPlanID);
            List<MMOperationDetailPlanItemsInfo> list = new List<MMOperationDetailPlanItemsInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    MMOperationDetailPlanItemsInfo objOperationDetailPlanItemsInfo = (MMOperationDetailPlanItemsInfo)GetObjectFromDataRow(row);
                    list.Add(objOperationDetailPlanItemsInfo);
                }
            }
            ds.Dispose();
            return list;
        }
        public List<MMOperationDetailPlanItemsInfo> GetOperationDetailPlanItemRP149Detail(string serial)
        {
            DataSet ds = dal.GetDataSet("MMOperationDetailPlanItems_GetOperationDetailPlanItemRP149Detail", serial);
            List<MMOperationDetailPlanItemsInfo> list = new List<MMOperationDetailPlanItemsInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    MMOperationDetailPlanItemsInfo obj = (MMOperationDetailPlanItemsInfo)GetObjectFromDataRow(row);
                    obj.MMOperationDetailPlanItemSynchronousPercent = obj.ReceiptedQty / obj.MMOperationDetailPlanItemChildPlanProductQty * 100;

                    list.Add(obj);
                }
            }
            ds.Dispose();
            return list;
        }
        public List<MMOperationDetailPlanItemsInfo> GetOperationDetailPlanItemOutSourcingRemain()
        {
            DataSet ds = dal.GetDataSet("MMOperationDetailPlanItems_GetOperationDetailPlanItemOutSourcingRemain");
            List<MMOperationDetailPlanItemsInfo> list = new List<MMOperationDetailPlanItemsInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    MMOperationDetailPlanItemsInfo obj = (MMOperationDetailPlanItemsInfo)GetObjectFromDataRow(row);
                    list.Add(obj);
                }
            }
            ds.Dispose();
            return list;
        }
        public List<MMOperationDetailPlanItemsInfo> GetOperationDetailPlanItemByOperationDetailPlan(int operationPlanID)
        {
            DataSet ds = this.GetAllDataByForeignColumn("FK_MMOperationDetailPlanID", operationPlanID);
            List<MMOperationDetailPlanItemsInfo> list = new List<MMOperationDetailPlanItemsInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    MMOperationDetailPlanItemsInfo objOperationDetailPlanItemsInfo = (MMOperationDetailPlanItemsInfo)GetObjectFromDataRow(row);
                    list.Add(objOperationDetailPlanItemsInfo);
                }
            }
            ds.Dispose();
            return list;
        }

        public void UpdateOperationDetailPlanItemBlock(int OperationDetailPlanItemID)
        {
            dal.ExecuteStoredProcedure("MMOperationDetailPlanItemChilds_UpdateOperationDetailPlanItemBlock", OperationDetailPlanItemID);
        }
        public List<MMOperationDetailPlanItemsInfo> GetOperationDetailPlanItemByOperationDetailPlanAndSomeCriteria(int ProductID, int operationPlanID, int batchProductID)
        {
            DataSet ds = dal.GetDataSet("MMOperationDetailPlanItems_GetOperationDetailPlanItemByOperationDetailPlanAndSomeCriteria", ProductID, operationPlanID, batchProductID);
            List<MMOperationDetailPlanItemsInfo> list = new List<MMOperationDetailPlanItemsInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    MMOperationDetailPlanItemsInfo objOperationDetailPlanItemsInfo = (MMOperationDetailPlanItemsInfo)GetObjectFromDataRow(row);
                    list.Add(objOperationDetailPlanItemsInfo);
                }
            }
            ds.Dispose();
            return list;
        }
    }
    #endregion
}