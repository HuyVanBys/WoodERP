using BOSLib;
using System;
using System.Collections.Generic;
using System.Data;


namespace BOSERP
{
    #region ARDeliveryPlans
    //-----------------------------------------------------------
    //Generated By: BOS Studio
    //Class:ARDeliveryPlansController
    //Created Date:19 Tháng Ba 2018
    //-----------------------------------------------------------

    public class ARDeliveryPlansController : BaseBusinessController
    {
        public ARDeliveryPlansController()
        {
            dal = new DALBaseProvider("ARDeliveryPlans", typeof(ARDeliveryPlansInfo));
        }

        public override System.Collections.IList GetListFromDataSet(DataSet ds)
        {
            List<ARDeliveryPlansInfo> DeliveryPlansList = new List<ARDeliveryPlansInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    ARDeliveryPlansInfo objDeliveryPlansInfo = (ARDeliveryPlansInfo)GetObjectFromDataRow(row);
                    DeliveryPlansList.Add(objDeliveryPlansInfo);
                }
            }
            ds.Dispose();
            return DeliveryPlansList;
        }

        public List<ARDeliveryPlansInfo> GetAllDeliveryPlanCompleted()
        {
            DataSet ds = dal.GetDataSet("ARDeliveryPlans_GetAllDeliveryPlanCompleted");
            List<ARDeliveryPlansInfo> deliveryPlans = new List<ARDeliveryPlansInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    ARDeliveryPlansInfo objDeliveryPlanInfo = (ARDeliveryPlansInfo)GetObjectFromDataRow(row);
                    deliveryPlans.Add(objDeliveryPlanInfo);
                }
            }
            return deliveryPlans;
        }

        public DataSet GetAllDeliveryPlanDataSet(string arDeliveryPlanNo,
                                                 string arDeliveryPlanName,
                                                 int? fk_HREmployeeID,
                                                 DateTime arDeliveryPlanBeginDateFrom,
                                                 DateTime arDeliveryPlanBeginDateTo,
                                                 DateTime arDeliveryPlanEndDateFrom,
                                                 DateTime arDeliveryPlanEndDateTo,
                                                 int? productID)
        {
            DataSet ds = dal.GetDataSet("ARDeliveryPlans_GetAllDeliveryPlanDataSet",
                                        arDeliveryPlanNo,
                                        arDeliveryPlanName,
                                        fk_HREmployeeID,
                                        arDeliveryPlanBeginDateFrom,
                                        arDeliveryPlanBeginDateTo,
                                        arDeliveryPlanEndDateFrom,
                                        arDeliveryPlanEndDateTo,
                                        productID);
            return ds;
        }
        public DataSet GetAllDeliveryPlanBayUserDataSet(string arDeliveryPlanNo,
                                                 string arDeliveryPlanName,
                                                 int? fk_HREmployeeID,
                                                 DateTime arDeliveryPlanBeginDateFrom,
                                                 DateTime arDeliveryPlanBeginDateTo,
                                                 DateTime arDeliveryPlanEndDateFrom,
                                                 DateTime arDeliveryPlanEndDateTo,
                                                 int? productID,
                                                 int? userID
            )
        {
            DataSet ds = dal.GetDataSet("ARDeliveryPlans_GetAllDeliveryPlanBayUserDataSet",
                                        arDeliveryPlanNo,
                                        arDeliveryPlanName,
                                        fk_HREmployeeID,
                                        arDeliveryPlanBeginDateFrom,
                                        arDeliveryPlanBeginDateTo,
                                        arDeliveryPlanEndDateFrom,
                                        arDeliveryPlanEndDateTo,
                                        productID,
                                        userID
                                        );
            return ds;
        }

        public DataSet GetAllTransferPlanDataSet(string arDeliveryPlanNo,
                                                string arDeliveryPlanName,
                                                int? fk_HREmployeeID,
                                                DateTime arDeliveryPlanBeginDateFrom,
                                                DateTime arDeliveryPlanBeginDateTo,
                                                DateTime arDeliveryPlanEndDateFrom,
                                                DateTime arDeliveryPlanEndDateTo)
        {
            DataSet ds = dal.GetDataSet("ARDeliveryPlans_GetAllTransferPlanDataSet",
                                        arDeliveryPlanNo,
                                        arDeliveryPlanName,
                                        fk_HREmployeeID,
                                        arDeliveryPlanBeginDateFrom,
                                        arDeliveryPlanBeginDateTo,
                                        arDeliveryPlanEndDateFrom,
                                        arDeliveryPlanEndDateTo);
            return ds;
        }

        public List<ARDeliveryPlansInfo> GetDeliveryPlanForMultiSummaryRP(int deliveryPlanID, string deliveryPlanType, DateTime? fromDate, DateTime? toDate)
        {
            DataSet ds = dal.GetDataSet("ARDeliveryPlans_GetDeliveryPlanForMultiSummaryRP", deliveryPlanID, deliveryPlanType, fromDate, toDate);
            return (List<ARDeliveryPlansInfo>)GetListFromDataSet(ds);
        }

        public List<ARDeliveryPlansInfo> GetStatusDeliveryPlanByRef(string deliveryPlanRef)
        {
            DataSet ds = dal.GetDataSet("ARDeliveryPlans_GetStatusDeliveryPlanByRef", deliveryPlanRef);
            return (List<ARDeliveryPlansInfo>)GetListFromDataSet(ds);
        }
        public List<ARDeliveryPlansInfo> GetDeliveryPlansBySaleOrder(int SaleOrderID)
        {
            DataSet ds = dal.GetDataSet("ARDeliveryPlans_GetDeliveryPlansBySaleOrder", SaleOrderID);
            List<ARDeliveryPlansInfo> DeliveryPlanList = new List<ARDeliveryPlansInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    ARDeliveryPlansInfo objDeliveryPlansInfo = (ARDeliveryPlansInfo)GetObjectFromDataRow(row);
                    DeliveryPlanList.Add(objDeliveryPlansInfo);
                }
            }
            ds.Dispose();
            return DeliveryPlanList;
        }

        public List<ARDeliveryPlansInfo> GetDeliveryPlanNosList(string deliveryPlanItemIDs)
        {
            DataSet ds = dal.GetDataSet("ARDeliveryPlans_GetDeliveryPlanNosList", deliveryPlanItemIDs);
            return (List<ARDeliveryPlansInfo>)GetListFromDataSet(ds);
        }
        public void UpdateDeliveryPlanDate(int deliveryPlanID, DateTime deliveryPlanDate)
        {
            dal.ExecuteStoredProcedure("ARDeliveryPlans_UpdateDeliveryPlanDate", deliveryPlanID, deliveryPlanDate);
        }
        #endregion
    }
}