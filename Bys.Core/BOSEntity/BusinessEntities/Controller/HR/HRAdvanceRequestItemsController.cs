using BOSLib;
using System;
using System.Collections.Generic;
using System.Data;


namespace BOSERP
{
    #region HRAdvanceRequestItems
    //-----------------------------------------------------------
    //Generated By: BOS Studio
    //Class:HRAdvanceRequestItemsController
    //Created Date:Monday, June 13, 2016
    //-----------------------------------------------------------

    public class HRAdvanceRequestItemsController : BaseBusinessController
    {
        public HRAdvanceRequestItemsController()
        {
            dal = new DALBaseProvider("HRAdvanceRequestItems", typeof(HRAdvanceRequestItemsInfo));
        }
        public override System.Collections.IList GetListFromDataSet(DataSet ds)
        {
            List<HRAdvanceRequestItemsInfo> advanceRequestItems = new List<HRAdvanceRequestItemsInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    HRAdvanceRequestItemsInfo objHRAdvanceRequestItemsInfo = (HRAdvanceRequestItemsInfo)GetObjectFromDataRow(row);
                    advanceRequestItems.Add(objHRAdvanceRequestItemsInfo);
                }
            }
            ds.Dispose();
            return advanceRequestItems;
        }

        /// <summary>
        /// Get the purchase order list for invoicing
        /// </summary>
        /// <returns>List of purchase orders</returns>
        public HRAdvanceRequestItemsInfo GetAdvanceRequestItemsByAdvanceRequestIDAndEmployeeNo(int advanceRequestID, string employeeNo)
        {
            DataSet ds = dal.GetDataSet("HRAdvanceRequestItems_GetAdvanceRequestItemsByAdvanceRequestIDAndEmployeeNo", advanceRequestID, employeeNo);
            List<HRAdvanceRequestsInfo> advanceRequestList = new List<HRAdvanceRequestsInfo>();
            if (ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)
            {
                DataRow row = ds.Tables[0].Rows[0];

                HRAdvanceRequestItemsInfo objAdvanceRequestItemsInfo = (HRAdvanceRequestItemsInfo)GetObjectFromDataRow(row);
                return objAdvanceRequestItemsInfo;
            }
            return null;
        }

        public DataSet GetAdvanceRequestItemsFromDateToDateByEmployeeID(int employeeID, DateTime dateFrom, DateTime dateTo)
        {
            DataSet ds = dal.GetDataSet("HRAdvanceRequestItems_GetAdvanceRequestItemsFromDateToDateByEmployeeID", employeeID, dateFrom, dateTo);
            return ds;
        }

        public DataSet GetAdvanceRequestItemsByEmployeeIDAndFromDateToDate(int employeeID, DateTime dateFrom, DateTime dateTo, string type)
        {
            DataSet ds = dal.GetDataSet("HRAdvanceRequestItems_GetAdvanceRequestItemsByEmployeeIDAndFromDateToDate", employeeID, dateFrom, dateTo, type);
            return ds;
        }

        public List<HRAdvanceRequestItemsInfo> GetAdvanceRequestItemsForPaymentVoucher()
        {
            DataSet ds = dal.GetDataSet("HRAdvanceRequestItems_GetAdvanceRequestItemsForPaymentVoucher");
            return (List<HRAdvanceRequestItemsInfo>)GetListFromDataSet(ds);
        }

        public List<HRAdvanceRequestItemsInfo> GetAdvanceRequestItemsByEmployeeLoan()
        {
            DataSet ds = dal.GetDataSet("HRAdvanceRequestItems_GetAdvanceRequestItemsForNewEmployeeLoan");
            return (List<HRAdvanceRequestItemsInfo>)GetListFromDataSet(ds);
            ds.Dispose();
        }

        public List<HRAdvanceRequestItemsInfo> GetItemForAdvanceRefund(int employeeID, int currencyID)
        {
            DataSet ds = dal.GetDataSet("HRAdvanceRequestItems_GetItemForAdvanceRefund", employeeID, currencyID);
            return (List<HRAdvanceRequestItemsInfo>)GetListFromDataSet(ds);
        }

        public List<HRAdvanceRequestItemsInfo> GetAllAdvanceRequestItemsByAdvanceRequestID(int advanceRequestID)
        {
            DataSet ds = GetAllObjectsByObjectParentID(advanceRequestID);
            return (List<HRAdvanceRequestItemsInfo>)GetListFromDataSet(ds);
        }

        //public decimal GetEmployeeLoanMonthlyAmount(int employeeID, DateTime getMonth)
        //{
        //    decimal result = 0;
        //    DataSet ds = dal.GetDataSet("HRAdvanceRequestItems_GetEmployeeLoanMonthlyAmount", employeeID, getMonth);
        //    if (ds.Tables.Count > 0)
        //    {
        //        HRAdvanceRequestItemsInfo objAdvanceRequestItemsInfo = new HRAdvanceRequestItemsInfo();
        //        objAdvanceRequestItemsInfo = (HRAdvanceRequestItemsInfo)dal.GetSingleObject(ds.Tables[0]);
        //        if (objAdvanceRequestItemsInfo != null)
        //        {
        //            result = objAdvanceRequestItemsInfo.HRAdvanceRequestItemPaymentPerMonthAmount;
        //        }
        //    }
        //    return result;
        //}

        public HRAdvanceRequestItemsInfo GetEmployeeLoanMonthlyAmount(int employeeID, DateTime getMonth)
        {
            decimal result = 0;
            DataSet ds = dal.GetDataSet("HRAdvanceRequestItems_GetEmployeeLoanMonthlyAmount", employeeID, getMonth);
            HRAdvanceRequestItemsInfo objAdvanceRequestItemsInfo = new HRAdvanceRequestItemsInfo();
            if (ds.Tables.Count > 0)
            {
                objAdvanceRequestItemsInfo = (HRAdvanceRequestItemsInfo)dal.GetSingleObject(ds.Tables[0]);
                //if (objAdvanceRequestItemsInfo != null)
                //{
                //    result = objAdvanceRequestItemsInfo.HRAdvanceRequestItemPaymentPerMonthAmount;
                //}
            }
            return objAdvanceRequestItemsInfo;
        }

        public int GetDebitAccountIDFromAdvanceRequestItemID(int advanceRequestItemID)
        {
            Object obj = dal.GetSingleValue("HRAdvanceRequestItems_GetDebitAccountIDFromAdvanceRequestItemID", advanceRequestItemID);
            int Debt = 0;
            if (obj != null)
                int.TryParse(obj.ToString(), out Debt);
            return Debt;
        }

        public decimal GetEmployeeLoanMonthlyAmount(int employeeID, DateTime getMonth, string type)
        {
            decimal result = 0;
            DataSet ds = dal.GetDataSet("HRAdvanceRequestItems_GetEmployeeLoanMonthlyAmount", employeeID, getMonth, type);
            if (ds.Tables.Count > 0)
            {
                HRAdvanceRequestItemsInfo objAdvanceRequestItemsInfo = new HRAdvanceRequestItemsInfo();
                objAdvanceRequestItemsInfo = (HRAdvanceRequestItemsInfo)dal.GetSingleObject(ds.Tables[0]);
                if (objAdvanceRequestItemsInfo != null)
                {
                    result = objAdvanceRequestItemsInfo.HRAdvanceRequestItemPaymentPerMonthAmount;
                }
            }
            return result;
        }
    }
    #endregion
}