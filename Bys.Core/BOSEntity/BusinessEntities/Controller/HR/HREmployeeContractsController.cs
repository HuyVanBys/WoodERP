using BOSLib;
using System;
using System.Collections.Generic;
using System.Data;


namespace BOSERP
{
    #region HREmployeeContracts
    //-----------------------------------------------------------
    //Generated By: BOS Studio
    //Class:HREmployeeContractsController
    //Created Date:Thursday, October 10, 2013
    //-----------------------------------------------------------

    public class HREmployeeContractsController : BaseBusinessController
    {
        public HREmployeeContractsController()
        {
            dal = new DALBaseProvider("HREmployeeContracts", typeof(HREmployeeContractsInfo));
        }

        public List<HREmployeeContractsInfo> GetEmployeeContractsByEmployeeIDAndDate(int employeeID, DateTime dateTo)
        {
            List<HREmployeeContractsInfo> employeeContractsList = new List<HREmployeeContractsInfo>();
            DataSet ds = dal.GetDataSet("HREmployeeContracts_GetEmployeeContractsByEmployeeIDAndDate", employeeID, dateTo);
            if (ds.Tables[0].Rows.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    HREmployeeContractsInfo objEmployeeContractsInfo = (HREmployeeContractsInfo)GetObjectFromDataRow(row);
                    employeeContractsList.Add(objEmployeeContractsInfo);
                }
            }
            return employeeContractsList;
        }
        public List<HREmployeeContractsInfo> GetEmployeeContractsByEmployeeID(int employeeID)
        {
            List<HREmployeeContractsInfo> employeeContractsList = new List<HREmployeeContractsInfo>();
            DataSet ds = dal.GetAllDataByForeignColumn("FK_HREmployeeID", employeeID);
            if (ds.Tables[0].Rows.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    HREmployeeContractsInfo objEmployeeContractsInfo = (HREmployeeContractsInfo)GetObjectFromDataRow(row);
                    employeeContractsList.Add(objEmployeeContractsInfo);
                }
            }
            return employeeContractsList;
        }

        public List<HREmployeeContractsInfo> GetEmployeeContractsByEmployeeIDAndDateFrom(int employeeID, DateTime dateFrom)
        {
            List<HREmployeeContractsInfo> employeeContractsList = new List<HREmployeeContractsInfo>();
            DataSet ds = dal.GetDataSet("HREmployeeContracts_GetEmployeeContractsByEmployeeIDAndDateFrom", employeeID, dateFrom);
            if (ds.Tables[0].Rows.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    HREmployeeContractsInfo objEmployeeContractsInfo = (HREmployeeContractsInfo)GetObjectFromDataRow(row);
                    employeeContractsList.Add(objEmployeeContractsInfo);
                }
            }
            return employeeContractsList;
        }

        public List<HREmployeeContractsInfo> GetAllEmployeeContractByEmployeeID(int employeeID)
        {
            DataSet ds = dal.GetAllDataByForeignColumn("FK_HREmployeeID", employeeID);
            List<HREmployeeContractsInfo> list = new List<HREmployeeContractsInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    HREmployeeContractsInfo obj = (HREmployeeContractsInfo)GetObjectFromDataRow(row);
                    list.Add(obj);
                }
            }
            ds.Dispose();
            return list;
        }

        public override System.Collections.IList GetListFromDataSet(DataSet ds)
        {
            List<HREmployeeContractsInfo> lstObj = new List<HREmployeeContractsInfo>();
            if (ds.Tables.Count > 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    HREmployeeContractsInfo obj = (HREmployeeContractsInfo)GetObjectFromDataRow(row);
                    lstObj.Add(obj);
                }
            }
            ds.Dispose();
            return lstObj;
        }

        public DataSet GetEmployeeContractDefaultForLookup()
        {
            String strQuery = String.Format("SELECT TOP 1 * FROM dbo.HREmployeeContracts WHERE AAStatus = 'Alive'");
            return dal.GetDataSet(strQuery);
        }

        public List<HREmployeeContractsInfo> GetListContractCurrentByID(int employeeID, DateTime dateFrom, DateTime dateTo)
        {
            List<HREmployeeContractsInfo> employeeContractsList = new List<HREmployeeContractsInfo>();
            DataSet ds = dal.GetDataSet("HREmployeeContracts_GetContractUsingByID", employeeID, dateFrom, dateTo);
            if (ds != null)
            {
                if (ds.Tables[0].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[0].Rows)
                    {
                        HREmployeeContractsInfo objEmployeeContractsInfo = (HREmployeeContractsInfo)GetObjectFromDataRow(row);
                        employeeContractsList.Add(objEmployeeContractsInfo);
                    }
                }
            }
            return employeeContractsList;
        }

        public List<HREmployeeContractsInfo> HREmployeeContracts_GetListContractByEmployeeID(int employeeID, DateTime dateFrom, DateTime dateTo)
        {
            List<HREmployeeContractsInfo> employeeContractsList = new List<HREmployeeContractsInfo>();
            DataSet ds = dal.GetDataSet("HREmployeeContracts_GetAllContractByEmployeeID", employeeID, dateFrom, dateTo);
            if (ds != null)
            {
                if (ds.Tables[0].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[0].Rows)
                    {
                        HREmployeeContractsInfo objEmployeeContractsInfo = (HREmployeeContractsInfo)GetObjectFromDataRow(row);
                        employeeContractsList.Add(objEmployeeContractsInfo);
                    }
                }
            }
            return employeeContractsList;
        }

        public HREmployeeContractsInfo GetEmployeeContractLastByEmployeeID(int ID)
        {
            HREmployeeContractsInfo obj = null;
            DataSet ds = dal.GetDataSet("HREmployeeContracts_GetEmployeeContractLastByEmployeeID", ID);
            if (ds != null && ds.Tables.Count != 0)
            {
                if (ds.Tables[0].Rows.Count != 0)
                {
                    obj = (HREmployeeContractsInfo)GetObjectFromDataRow(ds.Tables[0].Rows[0]);
                }
            }
            return obj;
        }

    }
    #endregion
}