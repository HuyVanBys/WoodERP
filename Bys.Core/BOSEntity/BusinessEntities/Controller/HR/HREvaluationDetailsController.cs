using BOSLib;
using System.Data;


namespace BOSERP
{
    #region HREvaluationDetails
    //-----------------------------------------------------------
    //Generated By: BOS Studio
    //Class:HREvaluationDetailsController
    //Created Date:Thursday, May 26, 2011
    //-----------------------------------------------------------

    public class HREvaluationDetailsController : BaseBusinessController
    {
        public HREvaluationDetailsController()
        {
            dal = new DALBaseProvider("HREvaluationDetails", typeof(HREvaluationDetailsInfo));
        }

        /// <summary>
        /// Get evaluation details list of an employee by evaluation id and employee id
        /// </summary>
        /// <param name="evaluationID">ID of evaluation</param>
        /// <param name="employeeID">ID of employee who is evaluated</param>
        /// <returns>DataSet of an employee evaluation details list</returns>
        public DataSet GetEmployeeEvaluationDetailsByEvaluationIDAndEmployeeID(int evaluationID, int employeeID)
        {
            return dal.GetDataSet("HREvaluationDetails_GetEmployeeEvaluationDetailsByEvaluationIDAndEmployeeID", evaluationID, employeeID);
        }

        /// <summary>
        /// Get sum of total evaluation detail results of an employee by evaluation id and employee id
        /// </summary>
        /// <param name="evaluationID">ID of evaluation</param>
        /// <param name="employeeID">ID of employee</param>
        /// <returns>Sum of total evaluation detail results</returns>
        public decimal GetSumEvaluationDetailResultByEvaluationIDAndEmployeeID(int evaluationID, int employeeID)
        {
            DataSet ds = dal.GetDataSet("HREvaluationDetails_GetSumEvaluationDetailResultByEvaluationIDAndEmployeeID", evaluationID, employeeID);
            if (ds.Tables[0].Rows.Count > 0)
            {
                HREvaluationDetailsInfo objEvaluationDetailsInfo = new HREvaluationDetailsInfo();
                HREvaluationDetailsController objEvaluationDetailsController = new HREvaluationDetailsController();
                objEvaluationDetailsInfo = (HREvaluationDetailsInfo)objEvaluationDetailsController.GetObjectFromDataRow(ds.Tables[0].Rows[0]);
                if (objEvaluationDetailsInfo.HREvaluationDetailResult != null)
                {
                    return objEvaluationDetailsInfo.HREvaluationDetailResult;
                }
            }
            return 0;
        }
    }
    #endregion
}